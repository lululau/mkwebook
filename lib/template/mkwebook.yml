browser:  # browser settings
  headless: false  # headless mode
  window_size: [1440, 1024] # browser window size
  timeout: 30 # timeout for waiting for page loading
  # Any options accepted by Ferum::Browser.new are allowed here

concurrency: 16  # number of concurrent threads, default is no conccurency

authentication:  # authentication settings
  url: https://example.com/login # any page url which for inject cookie and local storage
  cookies: "auth_cookie_id=demo" # cookie string to be injected
  local-storage:  # local storage to be injected
    username: demo  # key and value
    auth_token: demo  # key and value

index-page:  # index page settings
  url: https://clojure.org/guides/repl/introduction  # URL of index page
  title: Clojure Guides  # title for the book, use page's title if not set
  modifier: |  # JavaScript code to modify the page
    document.body.innerHTML = document.querySelector('.clj-section-nav-container').outerHTML;
    document.querySelector('.clj-section-nav-container').style.width = '100%';
    document.body.style.backgroundColor = 'white';

  selector: "html"  # CSS selector for the content to be saved
  output: "index.html" # output file name
  link-selector: "a:not([href='../guides'])"  # CSS selector for links of content pages
  assets:  # assets to be downloaded
    - selector: "link[rel=stylesheet]" # CSS selector for assets
      attr: href  # attribute name for the asset URL
    - selector: "script[src]"
      attr: src


pages:  # settings for content pages
  - url-pattern: '.*'  # URL pattern for content page, only pages' URL matching this pattern will be processed
    modifier: |  # JavaScript code to modify the page
      document.body.innerHTML = document.querySelector('.clj-content-container').outerHTML;
      document.querySelector('.clj-content-container').style.width = '100%';
      document.body.style.backgroundColor = 'white';
      var style = document.createElement('style');
      style.innerHTML = '.clj-content-container { margin-left: 0; }';
      document.body.appendChild(style);
    selector: html   # CSS selector for the content to be saved
    assets:  # assets to be downloaded
      - selector: img  # CSS selector for assets
        attr: src  # attribute name for the asset URL
      - selector: "link[rel=stylesheet]"
        attr: href
      - selector: "script[src]"
        attr: src
            
docset:  # config for generate docset
  name: "Clojure Guides"  # docset name
  keyword: "clojure"  # docset keyword
  icon: "clojure.png"  # docset icon
  index: "/index.html"  # docset index page
  pages:  # docset pages config
  - url-pattern: 'index.html'  # URL pattern for docset page, will match against local downloaded pages
    extractor: |  # JavaScript code to extract the content for docset page
      (function() {
        var links = [...document.querySelectorAll('a.data-url')];
        return links.map(link => {
          var name = link.innerText;
          var tag = link;
          while (tag.tagName != 'BODY') {
            tag = tag.parentElement;
            if (tag.previousElementSibling && tag.previousElementSibling.tagName == 'H1') {
              name = tag.previousElementSibling.innerText + ' - ' + name;
            }
          }
          return {  # Should return an array of objects with name, path, type attributes
            path: link.href,  # path of the page, should be relative to DEMO.docset/Contents/Resources/Documents (starts with /)
            name: name, # name of extracted element
            type: 'Guide' # type of extracted element
          };
        });
      })();
